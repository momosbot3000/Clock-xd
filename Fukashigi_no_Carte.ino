void setup() {
  Serial.begin(9600);
  pinMode(11, OUTPUT);

  uint8_t Notes[][2] = {
    {42, 4}, {49, 4}, {47, 4}, //0
    {49, 12}, {42, 4}, {49, 4}, {47, 4}, //1
    {49, 12}, {42, 4}, {49, 4}, {47, 4}, //2
    {44, 12}, {45, 16}, //3
    {0, 8}, {42, 4}, {49, 4}, {47, 4}, //4
    {49, 12}, {42, 4}, {49, 4}, {47, 4}, //5
    {52, 12}, {50, 12}, //6
    {49, 24}, //7
    {45, 4}, {44, 4}, {40, 4}, {42, 4}, {49, 4}, {47, 4}, //8
    {48, 1}, {49, 11}, {52, 12}, //9
    {49, 12}, {47, 8}, {0, 4}, //10
    {44, 12}, {45, 12}, //11
    {49, 8}, {0, 4}, {42, 4}, {49, 4}, {47, 4}, //12
    {49, 12}, {42, 4}, {49, 4}, {47, 4}, //13
    {45, 12}, {41, 12}, //14
    {44, 36}, //15
    {0, 12}, //16
    {42, 18}, {43, 6}, //17
    {43, 18}, {0, 6}, //18
    {44, 18}, {45, 6}, //19
    {41, 12}, {42, 12}, //20
    {47, 32}, //21
    {0, 12}, //22
    {47, 18}, {48, 6}, //23
    {48, 3}, {0, 21}, //24
    {49, 18}, {50, 6}, //25
    {44, 12}, {42, 12}, //26
    {47, 16}, {42, 6}, //27
    {44, 24}, //28
    {0, 12}, {42, 12}, //29
    {44, 12}, {45, 12}, //30
    {44, 6}, {0, 6}, {42, 3}, {41, 3}, {42, 3}, {44, 3}, //31
    {49, 3}, {44, 3}, {49, 3}, {51, 3}, {53, 3}, {51, 3}, {53, 3}, {54, 3}, //32
    {56, 18}, {57, 6}, //33
    {57, 24}, //34
    {58, 18}, {59, 6}, //35
    {55, 12}, {56, 12}, //36 
    {61, 12}, {56, 6}, {53, 6}, //37
    {49, 6}, {44, 6}, {41, 6}, {37, 6}, //38
    {49, 18}, {50, 6}, //39
    {50, 18}, {0, 6}, //40
    {51, 18}, {52, 6}, //41
    {46, 12}, {44, 12}, //42
    {49, 18}, {46, 6}, //43
    {46, 24}, //44
    {0, 12}, {46, 1}, {47, 11}, //45
    {46, 12}, {44, 12}, //46
    {45, 6}, {0, 6}, {49, 6}, {0, 6}, //47
    {52, 6}, {0, 6}, {48, 6}, {0, 6}, //48
    {49, 3}, {0, 21}, //49
    {0, 12}, {42, 4}, {49, 4}, {47, 4}, //50
    {49, 12}, {42, 4}, {49, 4}, {47, 4}, //51
    {49, 12}, {42, 4}, {49, 4}, {47, 4}, //52
    {43, 1}, {44, 11}, {45, 12}, //53
    {0, 12}, {42, 4}, {49, 4}, {47, 4}, //54
    {49, 12}, {42, 4}, {49, 4}, {47, 4}, //55
    {50, 1}, {52, 11}, {50, 12}, //56
    {49, 24}, //57
    {0, 12}, {42, 4}, {49, 4}, {47, 4}, //58
    {49, 11}, {50, 1}, {52, 12}, //59
    {49, 12}, {47, 12}, //60
    {44, 12}, {45, 12}, //61
    {49, 12}, {42, 4}, {49, 4}, {47, 4}, //62
    {49, 12}, {42, 4}, {49, 4}, {47, 4}, //63
    {45, 12}, {41, 12}, //64
    {44, 12}, {44, 4}, {42, 4}, {44, 4}, //65
    {45, 12}, {42, 4}, {49, 4}, {47, 4}, //66
    {49, 12}, {42, 4}, {49, 4}, {47, 4}, //67
    {45, 12}, {41, 12}, //68
    {44, 36}, //69
    {0, 12} //70
  };


  byte bpm = 140;
  byte buzzer = 11;
  int SizeNotes =  (sizeof(Notes) / sizeof(*Notes));

  Play(Notes, SizeNotes, bpm, buzzer);
  
}


void loop() {
  
  
}

float Frecuency(int note, int octave){
  
  int hz = 440 * pow(1.05946309436, 12 * (octave - 4) + note - 10);
  return hz;

}


float nKey_Hz(uint8_t nKey){

  if(nKey >= 1 && nKey <= 88){
    int sum = 0;
    nKey += 9;
    while(nKey > 12){
      sum++;    
      nKey -= 12;
    }
    int N = nKey;
    int Oc = sum;
  
    float hz = Frecuency(N, Oc);
    return hz;
  }
  else {
    return 0;
  }
}


void Play(uint8_t Notes[][2], int SizeNotes, byte bpm, byte buzzer){
  
  float start = millis();
  float keep = start;
  float beatDuration = 60000 / bpm;

  for (int i = 0; i < SizeNotes; i++) {
    
    float noteDuration = (Notes[i][1] * beatDuration) / 8; 
    float Frecuency = nKey_Hz(Notes[i][0]);

    if(Frecuency > 0){    
      while(millis() <= keep + (noteDuration * 0.9)){
        tone(buzzer, Frecuency);
      }
      while(millis() >= keep + (noteDuration * 0.9) && millis() <= keep + noteDuration){    
        noTone(buzzer);
      }
    }
    else{
      while(millis() <= keep + noteDuration){
        noTone(buzzer);
      }
    }
    keep += noteDuration;
  }
}